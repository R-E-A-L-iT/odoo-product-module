<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--Add Custom Javascript-->
    <template id="assets_frontend" inherit_id="web.assets_frontend" priority="17">
        <xpath expr="." position="inside">

            <script type="text/javascript" src="/proquotes/static/src/JS/fold.js"></script>
            <script type="text/javascript" src="/proquotes/static/src/JS/multipleChoice.js"></script>

        </xpath>
    </template>
    
    
    <template id="sale_order_portal_content" inherit_id="sale_management.sale_order_portal_content_inherit_sale_management" priority="17">
        
        
        <xpath expr="//t[@t-foreach=&quot;sale_order.order_line;&quot;]/tr" position="after">
            <label for="multiple{{line}}{{line_index}}"></label>
            <input id="multiple{{line}}{{line_index}}"></input>
        </xpath>
        <!--Add Check Box to control fold Section-->
        <xpath expr="//t[@t-if=&quot;line.display_type == 'line_section'&quot;]/td/span" position="replace">
        
            <label t-attf-for="fold{{line}}{{line_index}}" style="display: inline-block; width: 100%; height: 100%;">
                <span t-field="line.name"/>
            </label>
            
            <!--Apply Custom Class to Special Section Types if needed-->
            <input t-if="line.special == 'multiple'" t-attf-id="fold{{line}}{{line_index}}" class="foldInput multipleChoice" type="checkbox" style="display: none;"/>
            <input t-elif="line.special == 'optional'" t-attf-id="fold{{line}}{{line_index}}" class="foldInput optionalSection" type="checkbox" style="display: none"/> 
            <input t-else="" t-attf-id="fold{{line}}{{line_index}}" class="foldInput" type="checkbox" style="display: none;"/>
            
        </xpath>
        <!--Move Subtitle display-->
        <xpath expr="//t[@t-if=&quot;line.display_type == 'line_section'&quot;]/td" position="after">
            <td>
            <label t-attf-for="fold{{line}}{{line_index}}" style="display: inline-block; width: 100%; height: 100%;">
                <strong class="text-right" style="font-weight: bolder">Subtotal</strong>
                <span class="subtotal-destination text-right" style="font-weight: 400 !important;"></span>
            </label>
            </td>
        </xpath>
        
        <!--Hide Default Subtotal-->
        <xpath expr="//t[@t-if=&quot;current_section and (line_last or sale_order.order_line[line_index+1].display_type == 'line_section')&quot;]/tr" position="attributes">
            <attribute name="style">display: none;</attribute>
        </xpath>
        
        <!--Mark Original Subtotal locations-->
        <xpath expr="//t[@t-if=&quot;current_section and (line_last or sale_order.order_line[line_index+1].display_type == 'line_section')&quot;]/tr/td/span" position="attributes">
            <attribute name="class">subtotal-source</attribute>
        </xpath>
        
        <!--Apply HTML tags to description and Names-->
        <xpath expr="//td[@id=&quot;product_name&quot;]/span" position="replace">
            <t t-set="nameDescription" t-value="line.name"></t>
            <span t-raw="nameDescription"></span>
        </xpath>
        
    </template>
</odoo>